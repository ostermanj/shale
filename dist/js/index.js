!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createResultItem=function(e){var t,n;if(void 0===e.data.creators)t="";else if(t=(n=e.data.creators.map(function(e){return e.firstName+" "+e.lastName})).join(","),2===n.length)t=t.replace(","," and ");else if(n.length>4)t=n[0]+" et al.";else{var o=(t=t.replace(/,/g,", ")).lastIndexOf(",");-1!==o&&(t=t.substr(0,o+1)+" and"+t.substr(o+1))}var r=e.data.publisher||e.data.journalAbbreviation||e.data.publicationTitle||e.data.institution||e.data.websiteTitle||"",a="",i="";if(e.data.collections&&e.data.collections.length>0&&(i="<b>Topic:</b> ",e.data.collections.length>1&&(i="<b>Topics: </b>"),e.data.collections.forEach(function(e,t){var n=RFFApp.model.collections.find(function(t){return t.key===e}).data.name;i+=t>0?", "+n:n}),a+=i+"<br />"),e.data.url&&""!==e.data.url){var s=document.createElement("a");s.setAttribute("href",e.data.url),s.setAttribute("target","_blank"),s.setAttribute("class","details-link"),s.innerHTML="Go to link",a+=s.outerHTML+"<br />"}if(e.data.DOI&&""!==e.data.DOI&&(a+="DOI: "+e.data.DOI+"<br />"),e.bib&&""!==e.bib){var l=document.createElement("div");l.innerHTML=e.bib;var c=l.querySelector(".csl-entry").innerHTML,u=document.createElement("textarea");u.innerHTML=c,u.setAttribute("class","bib-container");var d=document.createElement("a");d.setAttribute("href","#"),d.setAttribute("class","details-link copy-bib"),d.innerHTML="Copy biblio. info",a+=u.outerHTML+d.outerHTML}return'\n              <div class="detail-results-wrapper">\n                  <div class="detail-results">'+(a=""!==a?a:"< nothing to show >")+'</div>\n              </div>\n              <div class="summary-results">\n                  <div class="flex space-between">\n                      <span class="flex item-info items-center">\n                          <span class="list-item__label">'+(e.synthesisType||e.data.itemType.undoCamelCase())+'</span>\n                          <span class="list-item__meta publisher-name">'+r.trunc(90,!0)+'</span>\n                      </span>\n                      <span class="list-item__meta">'+e.data.dateString+'</span>\n                  </div>\n                  <h3 class="list-item__title"><a class="item-title-link" href="#">'+e.data.title+'</a></h3>\n                  <span class="list-item__meta">'+t+"</span>\n              </div>\n              "}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createBrowseButton=function(e,t){var n;e.children&&(n=e.children.reduce(function(e,t){return e+t.data.name.cleanString()+" "},""));var o=document.createElement("div");o.innerHTML='\n  <div class="button button--secondary '+n+" "+(0===t?"active":"")+'">\n    <span>'+e.data.name+"</span>\n  </div>";var r=o.children[0];return r.onclick=function(){console.log(this),d3.selectAll("#browse-buttons .button").classed("active",!1),d3.select(this).classed("active",!0),RFFApp.controller.getCollectionItems(e.data.key)},r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.StringHelpers=(String.prototype.cleanString=function(){return this.replace(/[ /]/g,"-").replace(/['"”’“‘,.!?;()&]/g,"").toLowerCase()},String.prototype.removeUnderscores=function(){return this.replace(/_/g," ")},String.prototype.undoCamelCase=function(){return this.replace(/([A-Z])/g," $1").toLowerCase()},void(String.prototype.trunc=String.prototype.trunc||function(e,t){if(this.length<=e)return this;var n=this.substr(0,e-1);return(t?n.substr(0,n.lastIndexOf(" ")):n)+"..."}))},,function(e,t,n){},function(e,t,n){"use strict";n(4),n(2);var o,r,a,i,s=n(1),l=n(0);function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}o="2127948",r={gateCheck:0,init:function(e){this.getZoteroCollections(e),this.getZoteroItems(e)},childrenify:function(e){return console.log(e),e.forEach(function(t){if(!1!==t.data.parentCollection&&t.meta.numItems>0){var n=e.find(function(e){return e.key===t.data.parentCollection});void 0!==n&&(n.children=n.children||[],n.children.push(t))}}),e},getZoteroCollections:function(e){var t=this;e?d3.json("data/zoteroCollections-4-11-18.json",function(e,n){if(e)throw e;a.collections=t.childrenify(n),console.log("increment gateCheck from get collections"),t.gateCheck++,i.init()}):new Promise(function(e,n){d3.json("https://api.zotero.org/groups/"+o+"/collections?limit=100",function(o,r){if(o)throw n(o),o;console.log(JSON.stringify(r)),a.collections=t.childrenify(r),e(a.collections)})}).then(function(e){console.log(e),console.log("increment gateCheck from get collections"),t.gateCheck++,i.init()})},getZoteroItems:function(e){var t=this;if(e)d3.json("data/zoteroItems-4-11-18.json",function(e,n){if(e)throw e;a.zoteroItems=n,t.parseZoteroItemDates(),console.log("increment gateCheck from get items"),t.gateCheck++,i.init()});else{for(var n=[],r=[],s=0;s<9;s++)n.push(l(s));Promise.race(n).then(function(e){if(console.log(e),e.total>9){for(var o=9;o<Math.ceil(e.total/100);o++)r.push(l(o));Promise.all([].concat(n,r)).then(function(e){window.dateStrings=[],console.log(e),e.forEach(function(e){var t;(t=a.zoteroItems).push.apply(t,c(e.data))}),console.log(JSON.stringify(a.zoteroItems)),t.parseZoteroItemDates(),t.gateCheck++,i.init()})}else Promise.all(n).then(function(e){console.log(e),e.forEach(function(e){var t;(t=a.zoteroItems).push.apply(t,c(e.data))}),t.parseZoteroItemDates(),t.gateCeck++,i.init()})})}function l(e){return new Promise(function(t,n){d3.request("https://api.zotero.org/groups/"+o+"/items/top?include=data,bib&limit=100&start="+100*e,function(e,o){if(e)throw n(e),e;t({total:+o.getResponseHeader("Total-Results"),data:JSON.parse(o.responseText)})})})}},parseZoteroItemDates:function(){var e=this;a.zoteroItems.forEach(function(t){var n=e.getDatesFromString(t.data.date);t.data.dateString=n.display,t.data.dateValue=n.value}),a.zoteroItems.sort(function(e,t){return d3.descending(e.data.dateValue,t.data.dateValue)})},getCollectionItems:function(e){console.log(e);var t=a.collections.find(function(t){return t.key===e});console.log(t);var n=a.zoteroItems.filter(function(t){return-1!==t.data.collections.indexOf(e)});console.log(n);var o=[];t.children&&t.children.forEach(function(e){var t=a.zoteroItems.filter(function(t){return-1!==t.data.collections.indexOf(e.key)});t.forEach(function(t){t.synthesisType=e.data.name}),o.push.apply(o,c(t))}),i.filterResults(n),i.filterSynthesisResults(o)},getDatesFromString:function(e){var t=new Date(1776,3,4),n="",o={forthcoming:/forthcoming/,yyyy:/^(\d{4})$/,yyyymmdd:/(\d{4})[-/](\d{1,2})[-/](\d{1,2})/,monthddyyyy:/^(\w+)\.* *(\d{1,2}), *(\d{4})/,monthyyyy:/^(\w+)\.* (\d{4})/,yyyymm:/^(\d{4})[-/](\d{1,2})$/,mmddyyyy:/^(\d{1,2})[-/](\d{1,2})[-/](\d{4})/,yyyyyyyy:/^(\d{4})[-–—]\d{4}/,yyyymonthdd:/^(\d{4}) *(\w+)\.* *(\d{1,2})/};function r(e){return void 0!==a[e]&&isNaN(a[e])?a[e]:e}var a={0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December",January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11,Winter:11,Spring:2,Summer:5,Fall:8,Autumn:8,Jan:"January",Feb:"February",Mar:"March",Apr:"April",Jun:"June",Jul:"July",Aug:"August",Sep:"September",Sept:"September",Oct:"October",Nov:"Novemeber",Dec:"December"};for(var i in o)if(o.hasOwnProperty(i)&&void 0!==e){var s=e.match(o[i]);if(null!==s)switch(i){case"yyyy":n=e,t=new Date(+s[1],0,1);break;case"yyyymmdd":n=a[(+s[2]-1).toString()]+" "+ +s[3]+", "+s[1],t=new Date(+s[1],+s[2]-1,+s[3]);break;case"monthddyyyy":n=r(s[1])+" "+ +s[2]+", "+s[3],t=new Date(+s[3],a[r(s[1])],+s[2]);break;case"monthyyyy":n=r(s[1])+" "+s[2],t=new Date(+s[2],a[r(s[1])],1);break;case"yyyymm":n=a[+s[2]-1]+" "+s[1],t=new Date(+s[1],+s[2]-1,1);break;case"mmddyyyy":n=a[+s[1]-1]+" "+ +s[2]+", "+s[3],t=new Date(+s[3],+s[1]-1,+s[2]);break;case"yyyyyyyy":n=e.replace("-","—").replace("-","–"),t=new Date(+s[1],0,1);break;case"yyyymonthdd":n=r(s[2])+" "+ +s[3]+", "+s[1],t=new Date(+s[1],a[r(s[2])],+s[3]);break;case"forthcoming":n="forthcoming",t=new Date}}return{value:t,display:n}},copyBibText:function(){this.parentNode.querySelector(".bib-container").select();try{var e=document.execCommand("copy"),t=e?"successful":"unsuccessful";console.log("Copying text command was "+t),e&&alert("Bibliographical entry copied to clipboard")}catch(e){console.log("Oops, unable to copy")}}},a={zoteroItems:[]},i={init:function(){console.log(r.gateCheck),r.gateCheck<2||(console.log("READY!"),console.log(a.zoteroItems),this.renderTopicButtons(),this.results=d3.select("#results ul").classed("load",!1),console.log(a.collections),r.getCollectionItems(a.collections.find(function(e){return!1===e.data.parentCollection}).key))},renderTopicButtons:function(){var e=document.getElementById("browse-buttons"),t=0;a.collections.sort(function(e,t){return d3.ascending(e.data.name,t.data.name)}),a.collections.forEach(function(n){!1===n.data.parentCollection&&(e.appendChild((0,s.createBrowseButton)(n,t)),t++)}),this.renderShowAllButton()},renderShowAllButton:function(){d3.select("#browse-buttons").append("div").classed("button button--tertiary show-all",!0).on("click",function(){d3.selectAll("#browse-buttons .button").classed("active",!1),d3.select(this).classed("active",!0),i.filterResults.call(i),i.filterSynthesisResults.call(i,[])}).append("span").text("Show all")},filterResults:function(e){var t=this;console.log(e),console.log("filterResults",this);var n=void 0===e?a.zoteroItems:e,o=this.results.selectAll(".list-item").data(n,function(e){return e.data.key});o.exit().classed("entered",!1).classed("exiting",!0).transition(1500).remove();var i=o.enter().append("li").attr("class",function(e,t){return e.key+" "+e.data.itemType+" index-"+t+("RFF"===e.data.institution||"Resources for the Future"===e.data.institution?" RFF":"")}).classed("entering",!0).classed("list-item",!0).html(function(e){return(0,l.createResultItem)(e)}).on("click",function(e,n,o){d3.event.target.classList.contains("details-link")||t.showDetails(o[n])});setTimeout(function(){i.classed("entering",!1)}),this.items=i.merge(o),d3.selectAll(".item-title-link").on("click",function(){d3.event.preventDefault()}),d3.selectAll(".copy-bib").on("click",function(){d3.event.preventDefault(),r.copyBibText.call(this)})},showDetails:function(e){var t=d3.select(e);t.classed("show-details",!t.classed("show-details"))},filterSynthesisResults:function(e){console.log(e);var t=d3.select("#synthesis-results ul").selectAll(".list-item").data(e,function(e){return e.data.key});console.log(t),t.exit().classed("entered",!1).classed("exiting",!0).transition(1500).remove();var n=t.enter().append("li").attr("id",function(e){return e.key}).attr("class",function(e,t){return(e.synthesisType.cleanString()||e.data.itemType)+" index-"+t+("RFF"===e.data.institution||"Resources for the Future"===e.data.institution?" RFF":"")}).classed("RFF",!0).classed("entering",!0).classed("list-item",!0).html(function(e){return(0,l.createResultItem)(e)}).on("click",function(){window.open("./pdf/"+this.id+".pdf","_blank")});setTimeout(function(){n.classed("entering",!1)}),this.synthesisItems=n.merge(t),d3.selectAll(".item-title-link").on("click",function(){d3.event.preventDefault()})}},window.RFFApp={controller:r,model:a},r.init(!0)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvUmVzdWx0SXRlbXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvQnJvd3NlQnV0dG9ucy5qcyIsIndlYnBhY2s6Ly8vLi9oZWxwZXJzL3N0cmluZy1oZWxwZXJzLmpzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJ2YWx1ZSIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiY3JlYXRlUmVzdWx0SXRlbSIsImF1dGhvclN0ciIsImF1dGhvcnMiLCJ1bmRlZmluZWQiLCJkYXRhIiwiY3JlYXRvcnMiLCJtYXAiLCJlYWNoIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJqb2luIiwibGVuZ3RoIiwicmVwbGFjZSIsImxhc3RJbmRleE9mIiwic3Vic3RyIiwicHVibGlzaGVyIiwiam91cm5hbEFiYnJldmlhdGlvbiIsInB1YmxpY2F0aW9uVGl0bGUiLCJpbnN0aXR1dGlvbiIsIndlYnNpdGVUaXRsZSIsImRldGFpbHMiLCJ0b3BpY3MiLCJjb2xsZWN0aW9ucyIsImZvckVhY2giLCJ0b3BpY05hbWUiLCJSRkZBcHAiLCJtb2RlbCIsImZpbmQiLCJrZXkiLCJ1cmwiLCJsaW5rIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiaW5uZXJIVE1MIiwib3V0ZXJIVE1MIiwiRE9JIiwiYmliIiwicGxhY2Vob2xkZXIiLCJ0ZXh0T25seSIsInF1ZXJ5U2VsZWN0b3IiLCJiaWJDb250YWluZXIiLCJzeW50aGVzaXNUeXBlIiwiaXRlbVR5cGUiLCJ1bmRvQ2FtZWxDYXNlIiwidHJ1bmMiLCJkYXRlU3RyaW5nIiwidGl0bGUiLCJjcmVhdGVCcm93c2VCdXR0b24iLCJjb2xsZWN0aW9uIiwiaW5kZXgiLCJjaGlsZHJlbkNsYXNzIiwiY2hpbGRyZW4iLCJyZWR1Y2UiLCJhY2MiLCJjdXIiLCJjbGVhblN0cmluZyIsInBhcmVudCIsImJyb3dzZUJ1dHRvbiIsIm9uY2xpY2siLCJjb25zb2xlIiwibG9nIiwidGhpcyIsImQzIiwic2VsZWN0QWxsIiwiY2xhc3NlZCIsInNlbGVjdCIsImNvbnRyb2xsZXIiLCJnZXRDb2xsZWN0aW9uSXRlbXMiLCJTdHJpbmdIZWxwZXJzIiwiU3RyaW5nIiwidG9Mb3dlckNhc2UiLCJyZW1vdmVVbmRlcnNjb3JlcyIsInVzZVdvcmRCb3VuZGFyeSIsInN1YlN0cmluZyIsImdyb3VwSWQiLCJ2aWV3IiwiX0Jyb3dzZUJ1dHRvbnMiLCJfUmVzdWx0SXRlbXMiLCJnYXRlQ2hlY2siLCJpbml0IiwidXNlTG9jYWwiLCJnZXRab3Rlcm9Db2xsZWN0aW9ucyIsImdldFpvdGVyb0l0ZW1zIiwiY2hpbGRyZW5pZnkiLCJwYXJlbnRDb2xsZWN0aW9uIiwibWV0YSIsIm51bUl0ZW1zIiwibWF0Y2giLCJwdXNoIiwiX3RoaXMiLCJqc29uIiwiZXJyb3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aGVuIiwiX3RoaXMyIiwiem90ZXJvSXRlbXMiLCJwYXJzZVpvdGVyb0l0ZW1EYXRlcyIsImluaXRpYWxJdGVtc1Byb21pc2VzIiwic3Vic2VxdWVudEl0ZW1zUHJvbWlzZXMiLCJjb25zdHJ1Y3RQcm9taXNlIiwicmFjZSIsInRvdGFsIiwiTWF0aCIsImNlaWwiLCJhbGwiLCJjb25jYXQiLCJ2YWx1ZXMiLCJ3aW5kb3ciLCJkYXRlU3RyaW5ncyIsIl9tb2RlbCR6b3Rlcm9JdGVtcyIsImFwcGx5IiwiX3RvQ29uc3VtYWJsZUFycmF5IiwiX21vZGVsJHpvdGVyb0l0ZW1zMiIsImdhdGVDZWNrIiwicmVxdWVzdCIsInhociIsImdldFJlc3BvbnNlSGVhZGVyIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJfdGhpczMiLCJwYXJzZWREYXRlcyIsImdldERhdGVzRnJvbVN0cmluZyIsImRhdGUiLCJkaXNwbGF5IiwiZGF0ZVZhbHVlIiwic29ydCIsImEiLCJiIiwiZGVzY2VuZGluZyIsImNvbGxlY3Rpb25LZXkiLCJjb2xsZWN0aW9uSXRlbXMiLCJmaWx0ZXIiLCJ6IiwiaW5kZXhPZiIsInN5bnRoZXNpc0l0ZW1zIiwiY2hpbGQiLCJtYXRjaGVzIiwiZmlsdGVyUmVzdWx0cyIsImZpbHRlclN5bnRoZXNpc1Jlc3VsdHMiLCJzdHJpbmciLCJEYXRlIiwibWF0Y2hUeXBlcyIsImZvcnRoY29taW5nIiwieXl5eSIsInl5eXltbWRkIiwibW9udGhkZHl5eXkiLCJtb250aHl5eXkiLCJ5eXl5bW0iLCJtbWRkeXl5eSIsInl5eXl5eXl5IiwieXl5eW1vbnRoZGQiLCJjaGVja01vbnRoIiwic3RyIiwibW9udGhzIiwiaXNOYU4iLCIwIiwiMSIsIjIiLCIzIiwiNCIsIjUiLCI2IiwiNyIsIjgiLCI5IiwiMTAiLCIxMSIsIkphbnVhcnkiLCJGZWJydWFyeSIsIk1hcmNoIiwiQXByaWwiLCJNYXkiLCJKdW5lIiwiSnVseSIsIkF1Z3VzdCIsIlNlcHRlbWJlciIsIk9jdG9iZXIiLCJOb3ZlbWJlciIsIkRlY2VtYmVyIiwiV2ludGVyIiwiU3ByaW5nIiwiU3VtbWVyIiwiRmFsbCIsIkF1dHVtbiIsIkphbiIsIkZlYiIsIk1hciIsIkFwciIsIkp1biIsIkp1bCIsIkF1ZyIsIlNlcCIsIlNlcHQiLCJPY3QiLCJOb3YiLCJEZWMiLCJ0eXBlIiwidG9TdHJpbmciLCJjb3B5QmliVGV4dCIsInBhcmVudE5vZGUiLCJzdWNjZXNzZnVsIiwiZXhlY0NvbW1hbmQiLCJtc2ciLCJhbGVydCIsImVyciIsInJlbmRlclRvcGljQnV0dG9ucyIsInJlc3VsdHMiLCJzZWN0aW9uIiwiZ2V0RWxlbWVudEJ5SWQiLCJhc2NlbmRpbmciLCJhcHBlbmRDaGlsZCIsInJlbmRlclNob3dBbGxCdXR0b24iLCJhcHBlbmQiLCJvbiIsInRleHQiLCJfdGhpczQiLCJmaWx0ZXJlZERhdGEiLCJpdGVtcyIsImV4aXQiLCJ0cmFuc2l0aW9uIiwicmVtb3ZlIiwiZW50ZXJpbmciLCJlbnRlciIsImF0dHIiLCJodG1sIiwibm9kZXMiLCJldmVudCIsInRhcmdldCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwic2hvd0RldGFpbHMiLCJzZXRUaW1lb3V0IiwibWVyZ2UiLCJwcmV2ZW50RGVmYXVsdCIsImxpc3RJdGVtIiwiJGxpc3RJdGVtIiwib3BlbiIsImlkIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FDQUssY0FBQSxFQUNBQyxZQUFBLEVBQ0FDLElBQUFOLEtBTUFaLEVBQUFtQixFQUFBLFNBQUFqQixHQUNBWSxPQUFBQyxlQUFBYixFQUFBLGNBQWlEa0IsT0FBQSxLQUlqRHBCLEVBQUFxQixFQUFBLFNBQUFsQixHQUNBLElBQUFTLEVBQUFULEtBQUFtQixXQUNBLFdBQTJCLE9BQUFuQixFQUFBLFNBQzNCLFdBQWlDLE9B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QVMsU0FBQ3ZQLEVBQUVOLEdBQUgsT0FBV00sRUFBRTZELGNBQWNjLGVBQWlCM0UsRUFBRXVCLEtBQUt1QyxVQUFjLFVBQVlwRSxHQUE2QixRQUF2Qk0sRUFBRXVCLEtBQUtjLGFBQWdELDZCQUF2QnJDLEVBQUV1QixLQUFLYyxZQUE2QyxPQUFTLE1BQzlMK0MsUUFBUSxPQUFPLEdBQ2ZBLFFBQVEsWUFBWSxHQUNwQkEsUUFBUSxhQUFhLEdBQ3JCb0ssS0FBSyxTQUFBeFAsR0FBQSxPQUFLLEVBQUFpRyxFQUFBOUUsa0JBQWlCbkIsS0FDM0I2TyxHQUFHLFFBQVMsV0FDVDFHLE9BQU9pSSxLQUFLLFNBQVduTCxLQUFLb0wsR0FBSyxPQUFRLFlBR2pETixXQUFXLFdBQ1BWLEVBQVNqSyxRQUFRLFlBQVcsS0FHaENILEtBQUs2RSxlQUFpQnVGLEVBQVNXLE1BQU1mLEdBRXJDL0osR0FBR0MsVUFBVSxvQkFDUjBKLEdBQUcsUUFBUyxXQUNUM0osR0FBR3dLLE1BQU1PLHFCQUt6QjlILE9BQU92RixRQUNIMEMsYUFDQXpDLFNBRUp5QyxFQUFXYSxNQUFLIiwiZmlsZSI6ImpzL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA1KTtcbiIsImV4cG9ydCBjb25zdCBjcmVhdGVSZXN1bHRJdGVtID0gZnVuY3Rpb24oZCl7XG4gICAgLyogZ2xvYmFsIFJGRkFwcCAqL1xuICAgIHZhciBhdXRob3JTdHIsXG4gICAgICAgIGF1dGhvcnM7XG4gICAgaWYgKCBkLmRhdGEuY3JlYXRvcnMgPT09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgYXV0aG9yU3RyID0gJyc7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYXV0aG9ycyA9IGQuZGF0YS5jcmVhdG9ycy5tYXAoZWFjaCA9PiBlYWNoLmZpcnN0TmFtZSArICcgJyArIGVhY2gubGFzdE5hbWUpO1xuICAgICAgICBhdXRob3JTdHIgPSBhdXRob3JzLmpvaW4oJywnKTtcbiAgICAgICAgaWYgKGF1dGhvcnMubGVuZ3RoID09PSAyKXtcbiAgICAgICAgICAgIGF1dGhvclN0ciA9IGF1dGhvclN0ci5yZXBsYWNlKCcsJywnIGFuZCAnKTtcbiAgICAgICAgfSBlbHNlIGlmICggYXV0aG9ycy5sZW5ndGggPiA0ICkge1xuICAgICAgICAgICAgYXV0aG9yU3RyID0gYXV0aG9yc1swXSArICcgZXQgYWwuJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF1dGhvclN0ciA9IGF1dGhvclN0ci5yZXBsYWNlKC8sL2csJywgJyk7XG4gICAgICAgICAgICBsZXQgaSA9IGF1dGhvclN0ci5sYXN0SW5kZXhPZignLCcpO1xuICAgICAgICAgICAgaWYgKCBpICE9PSAtMSApe1xuICAgICAgICAgICAgICAgIGF1dGhvclN0ciA9IGF1dGhvclN0ci5zdWJzdHIoMCwgaSArIDEpICsgJyBhbmQnICsgYXV0aG9yU3RyLnN1YnN0cihpICsgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG5cbiAgICB2YXIgcHVibGlzaGVyID0gZC5kYXRhLnB1Ymxpc2hlciB8fCBkLmRhdGEuam91cm5hbEFiYnJldmlhdGlvbiB8fCBkLmRhdGEucHVibGljYXRpb25UaXRsZSB8fCBkLmRhdGEuaW5zdGl0dXRpb24gfHwgZC5kYXRhLndlYnNpdGVUaXRsZSB8fCAnJztcbiAgICB2YXIgZGV0YWlscyA9ICcnO1xuXG4gICAgdmFyIHRvcGljcyA9ICcnO1xuXG4gICAgaWYgKCBkLmRhdGEuY29sbGVjdGlvbnMgJiYgZC5kYXRhLmNvbGxlY3Rpb25zLmxlbmd0aCA+IDAgKSB7XG4gICAgICAgIHRvcGljcyA9ICc8Yj5Ub3BpYzo8L2I+ICc7XG4gICAgICAgIGlmICggZC5kYXRhLmNvbGxlY3Rpb25zLmxlbmd0aCA+IDEgKSB7XG4gICAgICAgICAgICB0b3BpY3MgPSAnPGI+VG9waWNzOiA8L2I+JztcbiAgICAgICAgfVxuICAgICAgICBkLmRhdGEuY29sbGVjdGlvbnMuZm9yRWFjaCgoYyxpKSA9PiB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGMsZCk7XG4gICAgICAgICAgICB2YXIgdG9waWNOYW1lID0gUkZGQXBwLm1vZGVsLmNvbGxlY3Rpb25zLmZpbmQoZCA9PiBkLmtleSA9PT0gYykuZGF0YS5uYW1lO1xuICAgICAgICAgICAgdG9waWNzICs9IGkgPiAwID8gJywgJyArIHRvcGljTmFtZSA6IHRvcGljTmFtZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRldGFpbHMgKz0gdG9waWNzICsgJzxiciAvPic7XG4gICAgfVxuXG5cbiAgICBpZiAoIGQuZGF0YS51cmwgJiYgZC5kYXRhLnVybCAhPT0gJycgKSB7XG4gICAgICAgIGxldCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIGQuZGF0YS51cmwpO1xuICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZSgndGFyZ2V0JywgJ19ibGFuaycpXG4gICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCdjbGFzcycsJ2RldGFpbHMtbGluaycpO1xuICAgICAgICBsaW5rLmlubmVySFRNTCA9ICdHbyB0byBsaW5rJztcbiAgICAgICAgZGV0YWlscyArPSBsaW5rLm91dGVySFRNTCArICc8YnIgLz4nO1xuICAgIH1cblxuICAgIGlmICggZC5kYXRhLkRPSSAmJiBkLmRhdGEuRE9JICE9PSAnJyApIHtcbiAgICAgICAgZGV0YWlscyArPSAnRE9JOiAnICsgZC5kYXRhLkRPSSArICc8YnIgLz4nO1xuICAgIH1cblxuICAgIGlmICggZC5iaWIgJiYgZC5iaWIgIT09ICcnICkge1xuICAgICAgICBsZXQgcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgcGxhY2Vob2xkZXIuaW5uZXJIVE1MID0gZC5iaWI7XG4gICAgICAgIGxldCB0ZXh0T25seSA9IHBsYWNlaG9sZGVyLnF1ZXJ5U2VsZWN0b3IoJy5jc2wtZW50cnknKS5pbm5lckhUTUw7XG4gICAgICAgIGxldCBiaWJDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xuICAgICAgICBiaWJDb250YWluZXIuaW5uZXJIVE1MID0gdGV4dE9ubHk7XG4gICAgICAgIGJpYkNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywnYmliLWNvbnRhaW5lcicpO1xuICAgICAgICBsZXQgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnIycpO1xuICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCdkZXRhaWxzLWxpbmsgY29weS1iaWInKTtcbiAgICAgICAgbGluay5pbm5lckhUTUwgPSAnQ29weSBiaWJsaW8uIGluZm8nO1xuICAgICAgICBkZXRhaWxzICs9IGJpYkNvbnRhaW5lci5vdXRlckhUTUwgKyBsaW5rLm91dGVySFRNTDtcbiAgICB9XG5cbiAgICBcblxuICAgIGRldGFpbHMgPSBkZXRhaWxzICE9PSAnJyA/IGRldGFpbHMgOiAnPCBub3RoaW5nIHRvIHNob3cgPic7XG5cbiAgICAgIHJldHVybiBgXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkZXRhaWwtcmVzdWx0cy13cmFwcGVyXCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGV0YWlsLXJlc3VsdHNcIj4keyBkZXRhaWxzIH08L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdW1tYXJ5LXJlc3VsdHNcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmbGV4IHNwYWNlLWJldHdlZW5cIj5cbiAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImZsZXggaXRlbS1pbmZvIGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImxpc3QtaXRlbV9fbGFiZWxcIj4ke2Quc3ludGhlc2lzVHlwZSB8fCBkLmRhdGEuaXRlbVR5cGUudW5kb0NhbWVsQ2FzZSgpfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJsaXN0LWl0ZW1fX21ldGEgcHVibGlzaGVyLW5hbWVcIj4ke3B1Ymxpc2hlci50cnVuYyg5MCx0cnVlKX08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibGlzdC1pdGVtX19tZXRhXCI+JHtkLmRhdGEuZGF0ZVN0cmluZ308L3NwYW4+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxoMyBjbGFzcz1cImxpc3QtaXRlbV9fdGl0bGVcIj48YSBjbGFzcz1cIml0ZW0tdGl0bGUtbGlua1wiIGhyZWY9XCIjXCI+JHtkLmRhdGEudGl0bGV9PC9hPjwvaDM+XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImxpc3QtaXRlbV9fbWV0YVwiPiR7YXV0aG9yU3RyfTwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIGA7XG59XG4iLCJleHBvcnQgY29uc3QgY3JlYXRlQnJvd3NlQnV0dG9uID0gZnVuY3Rpb24oY29sbGVjdGlvbiwgaW5kZXgpe1xuICAvKiBnbG9iYWwgZDMsIFJGRkFwcCAqL1xuICB2YXIgY2hpbGRyZW5DbGFzcztcbiAgaWYgKCBjb2xsZWN0aW9uLmNoaWxkcmVuICkge1xuICAgXG4gICAgY2hpbGRyZW5DbGFzcyA9IGNvbGxlY3Rpb24uY2hpbGRyZW4ucmVkdWNlKChhY2MsIGN1cikgPT4gYWNjICsgY3VyLmRhdGEubmFtZS5jbGVhblN0cmluZygpICsgJyAnLCAnJyk7XG4gIH1cbiAgdmFyIHBhcmVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBwYXJlbnQuaW5uZXJIVE1MID0gYFxuICA8ZGl2IGNsYXNzPVwiYnV0dG9uIGJ1dHRvbi0tc2Vjb25kYXJ5ICR7Y2hpbGRyZW5DbGFzc30gJHsgaW5kZXggPT09IDAgPyAnYWN0aXZlJyA6ICcnfVwiPlxuICAgIDxzcGFuPiR7Y29sbGVjdGlvbi5kYXRhLm5hbWV9PC9zcGFuPlxuICA8L2Rpdj5gO1xuXG4gIHZhciBicm93c2VCdXR0b24gPSBwYXJlbnQuY2hpbGRyZW5bMF07IFxuXG4gIGJyb3dzZUJ1dHRvbi5vbmNsaWNrID0gZnVuY3Rpb24oKXtcbiAgICBjb25zb2xlLmxvZyh0aGlzKTtcbiAgICBkMy5zZWxlY3RBbGwoJyNicm93c2UtYnV0dG9ucyAuYnV0dG9uJylcbiAgICAgIC5jbGFzc2VkKCdhY3RpdmUnLCBmYWxzZSk7XG4gICAgZDMuc2VsZWN0KHRoaXMpXG4gICAgICAuY2xhc3NlZCgnYWN0aXZlJywgdHJ1ZSk7XG4gICAgUkZGQXBwLmNvbnRyb2xsZXIuZ2V0Q29sbGVjdGlvbkl0ZW1zKGNvbGxlY3Rpb24uZGF0YS5rZXkpO1xuICB9O1xuXG4gIHJldHVybiBicm93c2VCdXR0b247IFxufVxuIiwiZXhwb3J0IGNvbnN0IFN0cmluZ0hlbHBlcnMgPSAoZnVuY3Rpb24oKXtcbiAgICBTdHJpbmcucHJvdG90eXBlLmNsZWFuU3RyaW5nID0gZnVuY3Rpb24oKSB7IC8vIGxvd2VyY2FzZSBhbmQgcmVtb3ZlIHB1bmN0dWF0aW9uIGFuZCByZXBsYWNlIHNwYWNlcyB3aXRoIGh5cGhlbnM7IGRlbGV0ZSBwdW5jdHVhdGlvblxuICAgICAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC9bIC9dL2csJy0nKS5yZXBsYWNlKC9bJ1wi4oCd4oCZ4oCc4oCYLC4hPzsoKSZdL2csJycpLnRvTG93ZXJDYXNlKCk7XG4gICAgfTtcblxuICAgIFN0cmluZy5wcm90b3R5cGUucmVtb3ZlVW5kZXJzY29yZXMgPSBmdW5jdGlvbigpIHsgXG4gICAgICAgIHJldHVybiB0aGlzLnJlcGxhY2UoL18vZywnICcpO1xuICAgIH07XG5cbiAgICBTdHJpbmcucHJvdG90eXBlLnVuZG9DYW1lbENhc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZSgvKFtBLVpdKS9nLCAnICQxJykudG9Mb3dlckNhc2UoKTtcbiAgICB9O1xuXG4gICAgU3RyaW5nLnByb3RvdHlwZS50cnVuYyA9IFN0cmluZy5wcm90b3R5cGUudHJ1bmMgfHwgLy8gaHQgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzExOTk0MjBcbiAgICAgICAgIGZ1bmN0aW9uKCBuLCB1c2VXb3JkQm91bmRhcnkgKXtcbiAgICAgICAgICAgICBpZiAodGhpcy5sZW5ndGggPD0gbikgeyByZXR1cm4gdGhpczsgfVxuICAgICAgICAgICAgIHZhciBzdWJTdHJpbmcgPSB0aGlzLnN1YnN0cigwLCBuLTEpO1xuICAgICAgICAgICAgIHJldHVybiAodXNlV29yZEJvdW5kYXJ5IFxuICAgICAgICAgICAgICAgID8gc3ViU3RyaW5nLnN1YnN0cigwLCBzdWJTdHJpbmcubGFzdEluZGV4T2YoJyAnKSkgXG4gICAgICAgICAgICAgICAgOiBzdWJTdHJpbmcpICsgXCIuLi5cIjtcbiAgICAgICAgICB9O1xufSkoKTsiLCJpbXBvcnQgJy4vY3NzL21haW4uc2Nzcyc7XG5pbXBvcnQgJy4uL2hlbHBlcnMvc3RyaW5nLWhlbHBlcnMnO1xuaW1wb3J0IHsgY3JlYXRlQnJvd3NlQnV0dG9uIH0gZnJvbSAnLi9jb21wb25lbnRzL0Jyb3dzZUJ1dHRvbnMnO1xuaW1wb3J0IHsgY3JlYXRlUmVzdWx0SXRlbSB9IGZyb20gJy4vY29tcG9uZW50cy9SZXN1bHRJdGVtcyc7IFxuICAgXG4oZnVuY3Rpb24oKXsgICAgIFxuLyogZ2xvYmFsIGQzICovXG5cInVzZSBzdHJpY3RcIjsgIFxuICAgIGNvbnN0IGdyb3VwSWQgPSAnMjEyNzk0OCc7XG4gICAgdmFyIGNvbnRyb2xsZXIgPSB7IFxuICAgICAgICBnYXRlQ2hlY2s6IDAsXG4gICAgICAgIGluaXQodXNlTG9jYWwpeyAvLyBwYXNzIGluIHRydWUgdG8gYnlwYXNzIEFQSSBhbmQgdXNlIGxvY2FsIGRhdGFcbiAgICAgICAgICAgIHRoaXMuZ2V0Wm90ZXJvQ29sbGVjdGlvbnModXNlTG9jYWwpO1xuICAgICAgICAgICAgdGhpcy5nZXRab3Rlcm9JdGVtcyh1c2VMb2NhbCk7ICBcbiAgICAgICAgICAvLyAgdmlldy5pbml0KCk7IFxuICAgICAgICB9LFxuICAgICAgICBjaGlsZHJlbmlmeShkYXRhKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOyBcbiAgICAgICAgICAgIGRhdGEuZm9yRWFjaChkID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIGQuZGF0YS5wYXJlbnRDb2xsZWN0aW9uICE9PSBmYWxzZSAmJiBkLm1ldGEubnVtSXRlbXMgPiAwICkgeyAvLyBpZSBoYXMgYSBwYXJlbnQgYW5kIGhhcyBpdGVtcyAoZXhjbHVkZSBlbXB0eSBzdWJjb2xsZWN0aW9ucylcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoID0gZGF0YS5maW5kKGNvbGxlY3Rpb24gPT4gY29sbGVjdGlvbi5rZXkgPT09IGQuZGF0YS5wYXJlbnRDb2xsZWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBtYXRjaCAhPT0gdW5kZWZpbmVkICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaC5jaGlsZHJlbiA9IG1hdGNoLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2guY2hpbGRyZW4ucHVzaChkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pOyBcbiAgICAgICAgICAgIHJldHVybiBkYXRhOyBcbiBcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0Wm90ZXJvQ29sbGVjdGlvbnModXNlTG9jYWwpeyAvLyBJTVBPUlRBTlQgdGhpcyB3aWxsIGJyZWFrIGlmICMgb2YgY29sbGVjdGlvbnMgZXhjZWVkcyAxMDAuIHdpbGwgbmVlZHMgdG8gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGltcGxlbWVudCBzdHJhdGVneSB1c2UgZm9yIGdldHRpbmcgaXRlbXNcblxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIHVzZUxvY2FsICl7XG4gICAgICAgICAgICAgICAgZDMuanNvbignZGF0YS96b3Rlcm9Db2xsZWN0aW9ucy00LTExLTE4Lmpzb24nLCAoZXJyb3IsZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIGVycm9yICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuY29sbGVjdGlvbnMgPSB0aGlzLmNoaWxkcmVuaWZ5KGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnaW5jcmVtZW50IGdhdGVDaGVjayBmcm9tIGdldCBjb2xsZWN0aW9ucycpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdhdGVDaGVjaysrO1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmluaXQoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIGQzLmpzb24oJ2h0dHBzOi8vYXBpLnpvdGVyby5vcmcvZ3JvdXBzLycgKyBncm91cElkICsgJy9jb2xsZWN0aW9ucz9saW1pdD0xMDAnLCAoZXJyb3IsZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsLmNvbGxlY3Rpb25zID0gdGhpcy5jaGlsZHJlbmlmeShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShtb2RlbC5jb2xsZWN0aW9ucyk7IFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwcm9taXNlLnRoZW4oZGF0YSA9PiB7ICBcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnaW5jcmVtZW50IGdhdGVDaGVjayBmcm9tIGdldCBjb2xsZWN0aW9ucycpO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2F0ZUNoZWNrKys7XG4gICAgICAgICAgICAgICAgdmlldy5pbml0KCk7XG4gICAgICAgICAgICB9KTsgXG4gICAgICAgIH0sIFxuICAgICAgICBnZXRab3Rlcm9JdGVtcyh1c2VMb2NhbCl7XG5cbiAgICAgICAgICAgIGlmICggdXNlTG9jYWwgKXtcbiAgICAgICAgICAgICAgICBkMy5qc29uKCdkYXRhL3pvdGVyb0l0ZW1zLTQtMTEtMTguanNvbicsIChlcnJvcixkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICggZXJyb3IgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBtb2RlbC56b3Rlcm9JdGVtcyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2Vab3Rlcm9JdGVtRGF0ZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2luY3JlbWVudCBnYXRlQ2hlY2sgZnJvbSBnZXQgaXRlbXMnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nYXRlQ2hlY2srKztcbiAgICAgICAgICAgICAgICAgICAgdmlldy5pbml0KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaW5pdGlhbEl0ZW1zUHJvbWlzZXMgPSBbXSxcbiAgICAgICAgICAgICAgICBzdWJzZXF1ZW50SXRlbXNQcm9taXNlcyA9IFtdLFxuICAgICAgICAgICAgICAgIGluaXRpYWxNYXggPSA5OyAvLyBsYXN0IGtub3duIG51bWJlciBvZiB0aW1lcyB0aGUgQVBJIG11c3QgYmUgaGl0IHRvIGdldCBhbGwgcmVzdWx0cy4gMTAwIHJldHVybmVkIGF0IGEgdGltZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gMyB3b3VsZCBnZXQgdXAgdG8gMzAwIGh1bmRyZWQuIHRpbWUgb2YgY29kaW5nIHRvdGFsIHdhcyAyODQ7IHdoZW4gdGhlIHRvYWwgaW5jcmVhc2VzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBjb2RlIGJlbG93IHdpbGwgbWFrZSBhZGRpdGlvbiBBUEkgY2FsbHNcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZnVuY3Rpb24gY29uc3RydWN0UHJvbWlzZShpKXtcbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLHJlamVjdCkgPT4geyAvLyB1c2luZyBkMy5yZXF1ZXN0IGluc3RlYWQgb2YgLmpzb24gdG8gaGF2ZSBhY2Nlc3MgdG8gdGhlIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlc3BvbnNlIGhlYWRlcnMuICdUb3RhbC1SZXN1bHRzJywgaW4gcGFydHVjdWxhclxuICAgICAgICAgICAgICAgICAgICBkMy5yZXF1ZXN0KCdodHRwczovL2FwaS56b3Rlcm8ub3JnL2dyb3Vwcy8nICsgZ3JvdXBJZCArICcvaXRlbXMvdG9wP2luY2x1ZGU9ZGF0YSxiaWImbGltaXQ9MTAwJnN0YXJ0PScgKyAoIGkgKiAxMDAgKSwgKGVycm9yLHhocikgPT4geyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogK3hoci5nZXRSZXNwb25zZUhlYWRlcignVG90YWwtUmVzdWx0cycpLCAvLyArIG9wZXJhbmQgY29lcmNlcyB0byBudW1iZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTsgXG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7ICAgICBcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yICggbGV0IGkgPSAwOyBpIDwgaW5pdGlhbE1heDsgaSsrICl7XG4gICAgICAgICAgICAgICAgaW5pdGlhbEl0ZW1zUHJvbWlzZXMucHVzaChjb25zdHJ1Y3RQcm9taXNlKGkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFByb21pc2UucmFjZShpbml0aWFsSXRlbXNQcm9taXNlcykudGhlbih2YWx1ZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmICggdmFsdWUudG90YWwgPiBpbml0aWFsTWF4ICkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKCBsZXQgaSA9IGluaXRpYWxNYXg7IGkgPCBNYXRoLmNlaWwodmFsdWUudG90YWwgLyAxMDApOyBpKysgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNlcXVlbnRJdGVtc1Byb21pc2VzLnB1c2goY29uc3RydWN0UHJvbWlzZShpKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgUHJvbWlzZS5hbGwoWy4uLmluaXRpYWxJdGVtc1Byb21pc2VzLC4uLnN1YnNlcXVlbnRJdGVtc1Byb21pc2VzXSkudGhlbigodmFsdWVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGF0ZVN0cmluZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHZhbHVlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMuZm9yRWFjaCh2YWx1ZSA9PiB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2codmFsdWUuZGF0YS5kYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC56b3Rlcm9JdGVtcy5wdXNoKC4uLnZhbHVlLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShtb2RlbC56b3Rlcm9JdGVtcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZVpvdGVyb0l0ZW1EYXRlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYXRlQ2hlY2srKztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuaW5pdCgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBQcm9taXNlLmFsbChpbml0aWFsSXRlbXNQcm9taXNlcykudGhlbigodmFsdWVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh2YWx1ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzLmZvckVhY2godmFsdWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLnpvdGVyb0l0ZW1zLnB1c2goLi4udmFsdWUuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2Vab3Rlcm9JdGVtRGF0ZXMoKTsgXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhdGVDZWNrKys7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3LmluaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7ICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBwYXJzZVpvdGVyb0l0ZW1EYXRlcygpe1xuICAgICAgICAgICAgbW9kZWwuem90ZXJvSXRlbXMuZm9yRWFjaChkID0+IHsgLy8gVE9ETyAgd2F5IHRvbyByZXBldGl0aXZlIG9mIGFib3ZlXG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBwYXJzZWREYXRlcyA9IHRoaXMuZ2V0RGF0ZXNGcm9tU3RyaW5nKGQuZGF0YS5kYXRlKTtcbiAgICAgICAgICAgICAgICBkLmRhdGEuZGF0ZVN0cmluZyA9IHBhcnNlZERhdGVzLmRpc3BsYXk7XG4gICAgICAgICAgICAgICAgZC5kYXRhLmRhdGVWYWx1ZSA9IHBhcnNlZERhdGVzLnZhbHVlO1xuICAgICAgICAgICAgfSk7IFxuICAgICAgICAgICAgbW9kZWwuem90ZXJvSXRlbXMuc29ydCgoYSxiKSA9PiBkMy5kZXNjZW5kaW5nKGEuZGF0YS5kYXRlVmFsdWUsIGIuZGF0YS5kYXRlVmFsdWUpKTsgXG4gICAgICAgIH0sXG4gICAgICAgIGdldENvbGxlY3Rpb25JdGVtcyhjb2xsZWN0aW9uS2V5KXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvbGxlY3Rpb25LZXkpO1xuICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBtb2RlbC5jb2xsZWN0aW9ucy5maW5kKGMgPT4gYy5rZXkgPT09IGNvbGxlY3Rpb25LZXkgKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvbGxlY3Rpb24pO1xuICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb25JdGVtcyA9IG1vZGVsLnpvdGVyb0l0ZW1zLmZpbHRlcih6ID0+IHouZGF0YS5jb2xsZWN0aW9ucy5pbmRleE9mKGNvbGxlY3Rpb25LZXkpICE9PSAtMSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhjb2xsZWN0aW9uSXRlbXMpO1xuICAgICAgICAgICAgdmFyIHN5bnRoZXNpc0l0ZW1zID0gW107IFxuICAgICAgICAgICAgaWYgKCBjb2xsZWN0aW9uLmNoaWxkcmVuICkge1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7IC8vIHRvIGRvIG1ha2UgbW9yZSBEUllcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoZXMgPSBtb2RlbC56b3Rlcm9JdGVtcy5maWx0ZXIoeiA9PiB6LmRhdGEuY29sbGVjdGlvbnMuaW5kZXhPZihjaGlsZC5rZXkpICE9PSAtMSk7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZXMuZm9yRWFjaChtYXRjaCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaC5zeW50aGVzaXNUeXBlID0gY2hpbGQuZGF0YS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3ludGhlc2lzSXRlbXMucHVzaCguLi5tYXRjaGVzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZpZXcuZmlsdGVyUmVzdWx0cyhjb2xsZWN0aW9uSXRlbXMpO1xuICAgICAgICAgICAgdmlldy5maWx0ZXJTeW50aGVzaXNSZXN1bHRzKHN5bnRoZXNpc0l0ZW1zKTtcbiAgICAgICAgICAgIC8qdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSxyZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICBkMy50ZXh0KCdodHRwczovL2FwaS56b3Rlcm8ub3JnL2dyb3Vwcy8nICsgZ3JvdXBJZCArICcvY29sbGVjdGlvbnMvJyArIGNvbGxlY3Rpb25LZXkgKyAnL2l0ZW1zP2Zvcm1hdD1rZXlzJywgKGVycm9yLHRleHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0ZXh0KTsgXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHByb21pc2UudGhlbih0ZXh0ID0+IHtcbiAgICAgICAgICAgICAgICB2YXIga2V5cyA9IHRleHQuc3BsaXQoJ1xcbicpOyAvLyBBUEkgcmVzcG9uc2UgaXMgdGV4dCBvZiBrZXlzIHdpdGggbmV3bGluZSBiZXR3ZWVuXG4gICAgICAgICAgICAgICAgaWYgKCBrZXlzW2tleXMubGVuZ3RoIC0gMV0gPT09ICcnICl7IC8vIHRoZSBsYXN0IGl0ZW0gc2VlbXMgdG8gYmUgYW4gZW1wdHkgc3RyaW5nIChuZXdsaW5lIGF0IGVuZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBjaGVja3MgZm9yIHRoYXQgYW5kIHJlbW92ZXMgaXQgKHBvcCgpKSBpZiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIGtleXMucG9wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7Ki9cbiAgICAgICAgfSxcbiAgICAgICAgZ2V0RGF0ZXNGcm9tU3RyaW5nKHN0cmluZyl7XG4gICAgICAgLy8gICAgIGNvbnNvbGUubG9nKHN0cmluZyk7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBuZXcgRGF0ZSgxNzc2LDMsNCksIC8vIHNvIHRoYXQgcHVicyB3aXRob3V0IGRhdGVzIGFyZSBzb3J0ZWQgcHJvcGVybHkgKG51bGwgPT0gMCA9PSAxOTcwKTtcbiAgICAgICAgICAgICAgICBkaXNwbGF5ID0gJycsXG4gICAgICAgICAgICAgICAgbWF0Y2hUeXBlcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgZm9ydGhjb21pbmc6L2ZvcnRoY29taW5nLyxcbiAgICAgICAgICAgICAgICAgICAgeXl5eTogICAgICAgL14oXFxkezR9KSQvLFxuICAgICAgICAgICAgICAgICAgICB5eXl5bW1kZDogICAvKFxcZHs0fSlbLS9dKFxcZHsxLDJ9KVstL10oXFxkezEsMn0pLywgXG4gICAgICAgICAgICAgICAgICAgIG1vbnRoZGR5eXl5Oi9eKFxcdyspXFwuKiAqKFxcZHsxLDJ9KSwgKihcXGR7NH0pLyxcbiAgICAgICAgICAgICAgICAgICAgbW9udGh5eXl5OiAgL14oXFx3KylcXC4qIChcXGR7NH0pLyxcbiAgICAgICAgICAgICAgICAgICAgeXl5eW1tOiAgICAgL14oXFxkezR9KVstL10oXFxkezEsMn0pJC8sXG4gICAgICAgICAgICAgICAgICAgIG1tZGR5eXl5OiAgIC9eKFxcZHsxLDJ9KVstL10oXFxkezEsMn0pWy0vXShcXGR7NH0pLyxcbiAgICAgICAgICAgICAgICAgICAgeXl5eXl5eXk6ICAgL14oXFxkezR9KVst4oCT4oCUXVxcZHs0fS8sXG4gICAgICAgICAgICAgICAgICAgIHl5eXltb250aGRkOi9eKFxcZHs0fSkgKihcXHcrKVxcLiogKihcXGR7MSwyfSkvIFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tNb250aChzdHIpe1xuICAgICAgICAgICAgICAgIGlmICggbW9udGhzW3N0cl0gIT09IHVuZGVmaW5lZCAmJiBpc05hTihtb250aHNbc3RyXSkgKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtb250aHNbc3RyXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0cjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIG1vbnRocyA9IHtcbiAgICAgICAgICAgICAgICAnMCc6ICdKYW51YXJ5JyxcbiAgICAgICAgICAgICAgICAnMSc6ICdGZWJydWFyeScsXG4gICAgICAgICAgICAgICAgJzInOiAnTWFyY2gnLFxuICAgICAgICAgICAgICAgICczJzogJ0FwcmlsJyxcbiAgICAgICAgICAgICAgICAnNCc6ICdNYXknLFxuICAgICAgICAgICAgICAgICc1JzogJ0p1bmUnLFxuICAgICAgICAgICAgICAgICc2JzogJ0p1bHknLFxuICAgICAgICAgICAgICAgICc3JzogJ0F1Z3VzdCcsXG4gICAgICAgICAgICAgICAgJzgnOiAnU2VwdGVtYmVyJyxcbiAgICAgICAgICAgICAgICAnOSc6ICdPY3RvYmVyJyxcbiAgICAgICAgICAgICAgICcxMCc6ICdOb3ZlbWJlcicsXG4gICAgICAgICAgICAgICAnMTEnOiAnRGVjZW1iZXInLFxuICAgICAgICAgICAgICAgICdKYW51YXJ5JzogIDAsXG4gICAgICAgICAgICAgICAgJ0ZlYnJ1YXJ5JzogMSxcbiAgICAgICAgICAgICAgICAnTWFyY2gnOiAgICAyLFxuICAgICAgICAgICAgICAgICdBcHJpbCc6ICAgIDMsXG4gICAgICAgICAgICAgICAgJ01heSc6ICAgICAgNCxcbiAgICAgICAgICAgICAgICAnSnVuZSc6ICAgICA1LFxuICAgICAgICAgICAgICAgICdKdWx5JzogICAgIDYsXG4gICAgICAgICAgICAgICAgJ0F1Z3VzdCc6ICAgNyxcbiAgICAgICAgICAgICAgICAnU2VwdGVtYmVyJzo4LFxuICAgICAgICAgICAgICAgICdPY3RvYmVyJzogIDksXG4gICAgICAgICAgICAgICAgJ05vdmVtYmVyJzogMTAsXG4gICAgICAgICAgICAgICAgJ0RlY2VtYmVyJzogMTEsXG4gICAgICAgICAgICAgICAgJ1dpbnRlcic6ICAgMTEsXG4gICAgICAgICAgICAgICAgJ1NwcmluZyc6ICAgMixcbiAgICAgICAgICAgICAgICAnU3VtbWVyJzogICA1LFxuICAgICAgICAgICAgICAgICdGYWxsJzogICAgIDgsXG4gICAgICAgICAgICAgICAgJ0F1dHVtbic6ICAgOCxcbiAgICAgICAgICAgICAgICAnSmFuJzogJ0phbnVhcnknLFxuICAgICAgICAgICAgICAgICdGZWInOiAnRmVicnVhcnknLFxuICAgICAgICAgICAgICAgICdNYXInOiAnTWFyY2gnLFxuICAgICAgICAgICAgICAgICdBcHInOiAnQXByaWwnLFxuICAgICAgICAgICAgICAgICdKdW4nOiAnSnVuZScsXG4gICAgICAgICAgICAgICAgJ0p1bCc6ICdKdWx5JyxcbiAgICAgICAgICAgICAgICAnQXVnJzogJ0F1Z3VzdCcsXG4gICAgICAgICAgICAgICAgJ1NlcCc6ICdTZXB0ZW1iZXInLFxuICAgICAgICAgICAgICAgICdTZXB0JzogJ1NlcHRlbWJlcicsXG4gICAgICAgICAgICAgICAgJ09jdCc6ICdPY3RvYmVyJyxcbiAgICAgICAgICAgICAgICAnTm92JzogJ05vdmVtZWJlcicsXG4gICAgICAgICAgICAgICAgJ0RlYyc6ICdEZWNlbWJlcidcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmb3IgKHZhciB0eXBlIGluIG1hdGNoVHlwZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIG1hdGNoVHlwZXMuaGFzT3duUHJvcGVydHkodHlwZSkgJiYgc3RyaW5nICE9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBtYXRjaCA9IHN0cmluZy5tYXRjaChtYXRjaFR5cGVzW3R5cGVdKTsgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBtYXRjaCAhPT0gbnVsbCApIHtcbiAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoIHR5cGUgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAneXl5eSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXkgPSBzdHJpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbmV3IERhdGUoK21hdGNoWzFdLDAsMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3l5eXltbWRkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheSA9IGAke21vbnRoc1soK21hdGNoWzJdIC0gMSkudG9TdHJpbmcoKV19ICR7K21hdGNoWzNdfSwgJHttYXRjaFsxXX1gOyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBuZXcgRGF0ZSgrbWF0Y2hbMV0sICttYXRjaFsyXSAtIDEsICttYXRjaFszXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vbnRoZGR5eXl5JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheSA9IGAke2NoZWNrTW9udGgobWF0Y2hbMV0pfSAkeyttYXRjaFsyXX0sICR7bWF0Y2hbM119YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBuZXcgRGF0ZSgrbWF0Y2hbM10sIG1vbnRoc1tjaGVja01vbnRoKG1hdGNoWzFdKV0sICttYXRjaFsyXSk7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb250aHl5eXknOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5ID0gYCR7Y2hlY2tNb250aChtYXRjaFsxXSl9ICR7bWF0Y2hbMl19YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBuZXcgRGF0ZSgrbWF0Y2hbMl0sIG1vbnRoc1tjaGVja01vbnRoKG1hdGNoWzFdKV0sIDEpOyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAneXl5eW1tJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheSA9IG1vbnRoc1soK21hdGNoWzJdIC0gMSldICsgJyAnICsgbWF0Y2hbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbmV3IERhdGUoK21hdGNoWzFdLCArbWF0Y2hbMl0gLSAxLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW1kZHl5eXknOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5ID0gYCR7bW9udGhzWygrbWF0Y2hbMV0gLSAxKV19ICR7K21hdGNoWzJdfSwgJHttYXRjaFszXX1gOyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBuZXcgRGF0ZSgrbWF0Y2hbM10sICttYXRjaFsxXSAtIDEsICttYXRjaFsyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3l5eXl5eXl5JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheSA9IHN0cmluZy5yZXBsYWNlKCctJywn4oCUJykucmVwbGFjZSgnLScsJ+KAkycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IG5ldyBEYXRlKCttYXRjaFsxXSwwLDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd5eXl5bW9udGhkZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXkgPSBgJHtjaGVja01vbnRoKG1hdGNoWzJdKX0gJHsrbWF0Y2hbM119LCAke21hdGNoWzFdfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbmV3IERhdGUoK21hdGNoWzFdLCBtb250aHNbY2hlY2tNb250aChtYXRjaFsyXSldLCArbWF0Y2hbM10pOyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZm9ydGhjb21pbmcnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5ID0gICdmb3J0aGNvbWluZyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gIG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgICBkaXNwbGF5XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBjb3B5QmliVGV4dCgpe1xuICAgICAgICAgIC8vIHRoaXMgPSBlbGVtZW50XG4gICAgICAgICAgdmFyIGJpYkVudHJ5ID0gdGhpcy5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5iaWItY29udGFpbmVyJyk7XG4gICAgICAgICAvLyBiaWJFbnRyeS5mb2N1cygpO1xuICAgICAgICAgIGJpYkVudHJ5LnNlbGVjdCgpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgc3VjY2Vzc2Z1bCA9IGRvY3VtZW50LmV4ZWNDb21tYW5kKCdjb3B5Jyk7XG4gICAgICAgICAgICB2YXIgbXNnID0gc3VjY2Vzc2Z1bCA/ICdzdWNjZXNzZnVsJyA6ICd1bnN1Y2Nlc3NmdWwnO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvcHlpbmcgdGV4dCBjb21tYW5kIHdhcyAnICsgbXNnKTtcbiAgICAgICAgICAgIGlmICggc3VjY2Vzc2Z1bCApIHtcbiAgICAgICAgICAgICAgICBhbGVydCgnQmlibGlvZ3JhcGhpY2FsIGVudHJ5IGNvcGllZCB0byBjbGlwYm9hcmQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdPb3BzLCB1bmFibGUgdG8gY29weScpO1xuICAgICAgICAgIH1cblxuICAgICAgICB9ICBcblxuXG4gICAgfTsgXG4gXG4gICAgdmFyIG1vZGVsID0ge1xuICAgICAgICB6b3Rlcm9JdGVtczogW10gICBcbiAgICB9OyBcbiAgICBcbiAgICB2YXIgdmlldyA9IHsgXG4gICAgICAgIGluaXQoKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvbnRyb2xsZXIuZ2F0ZUNoZWNrKTtcbiAgICAgICAgICAgIGlmICggY29udHJvbGxlci5nYXRlQ2hlY2sgPCAyICl7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygncmV0dXJuJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JFQURZIScpO1xuICAgICAgICAgICAgY29uc29sZS5sb2cobW9kZWwuem90ZXJvSXRlbXMpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJUb3BpY0J1dHRvbnMoKTtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0cyA9IGQzLnNlbGVjdCgnI3Jlc3VsdHMgdWwnKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKCdsb2FkJywgZmFsc2UpO1xuICAgICAgICAgICAgY29uc29sZS5sb2cobW9kZWwuY29sbGVjdGlvbnMpO1xuICAgICAgICAgICAgY29udHJvbGxlci5nZXRDb2xsZWN0aW9uSXRlbXMobW9kZWwuY29sbGVjdGlvbnMuZmluZChjID0+IGMuZGF0YS5wYXJlbnRDb2xsZWN0aW9uID09PSBmYWxzZSkua2V5KTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVuZGVyVG9waWNCdXR0b25zKCl7XG4gICAgICAgICAgICB2YXIgc2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicm93c2UtYnV0dG9ucycpLFxuICAgICAgICAgICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgICAgIG1vZGVsLmNvbGxlY3Rpb25zLnNvcnQoKGEsYikgPT4gZDMuYXNjZW5kaW5nKGEuZGF0YS5uYW1lLCBiLmRhdGEubmFtZSkpO1xuICAgICAgICAgICAgbW9kZWwuY29sbGVjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihkKXtcbiAgICAgICAgICAgICAgICBpZiAoIGQuZGF0YS5wYXJlbnRDb2xsZWN0aW9uID09PSBmYWxzZSApIHsgLy8gaS5lLiBpcyBhIHRvcC1sZXZlbCBjb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIHNlY3Rpb24uYXBwZW5kQ2hpbGQoY3JlYXRlQnJvd3NlQnV0dG9uKGQsIGluZGV4KSk7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlclNob3dBbGxCdXR0b24oKTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVuZGVyU2hvd0FsbEJ1dHRvbigpe1xuICAgICAgICAgICAgdmFyIHNob3dBbGwgPSBkMy5zZWxlY3QoJyNicm93c2UtYnV0dG9ucycpICAvLyBzaG91bGQgYmUgaW4gdGhlIHZpZXcgbW9kdWxlXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgnZGl2JylcbiAgICAgICAgICAgICAgICAuY2xhc3NlZCgnYnV0dG9uIGJ1dHRvbi0tdGVydGlhcnkgc2hvdy1hbGwnLHRydWUpXG4gICAgICAgICAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdEFsbCgnI2Jyb3dzZS1idXR0b25zIC5idXR0b24nKSAgLy8gbm90IERSWTsgbmVlZCB0byBicmluZyBvdXQgaW50byBmbjsgYnJvd3NlYnV0dG9ucyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkbyB0aGUgc2FtZSB0aGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoJ2FjdGl2ZScsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZCgnYWN0aXZlJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcuZmlsdGVyUmVzdWx0cy5jYWxsKHZpZXcpO1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmZpbHRlclN5bnRoZXNpc1Jlc3VsdHMuY2FsbCh2aWV3LFtdKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNob3dBbGwgICAgIFxuICAgICAgICAgICAgICAgIC5hcHBlbmQoJ3NwYW4nKVxuICAgICAgICAgICAgICAgIC50ZXh0KCdTaG93IGFsbCcpO1xuICAgICAgICB9LFxuICAgICAgICBmaWx0ZXJSZXN1bHRzKG1hdGNoZXMpe1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWF0Y2hlcyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZmlsdGVyUmVzdWx0cycsIHRoaXMpO1xuICAgICAgICAgICAgdmFyIGZpbHRlcmVkRGF0YSA9IG1hdGNoZXMgPT09IHVuZGVmaW5lZCA/IG1vZGVsLnpvdGVyb0l0ZW1zIDogbWF0Y2hlczsgXG5cbiAgICAgICAgICAgIHZhciBpdGVtcyA9IHRoaXMucmVzdWx0cy5zZWxlY3RBbGwoJy5saXN0LWl0ZW0nKVxuICAgICAgICAgICAgICAgIC5kYXRhKGZpbHRlcmVkRGF0YSwgZCA9PiBkLmRhdGEua2V5KTtcblxuICAgICAgICAgICAgLy8gdXBkYXRlIGV4aXN0aW5nXG4gICAgICAgICAgLyogIGl0ZW1zXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoJ2VudGVyZWQnLGZhbHNlKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKCdyZW1haW5lZCcsIHRydWUpO1xuKi9cbiAgICAgICAgICAgIC8vIHRyYW5zaXRpb24gYW5kIHJlbW92ZSBleGl0aW5nXG4gICAgICAgICAgICBpdGVtcy5leGl0KClcbiAgICAgICAgICAgICAgICAuY2xhc3NlZCgnZW50ZXJlZCcsZmFsc2UpXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoJ2V4aXRpbmcnLCB0cnVlKVxuICAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKDE1MDApLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICB2YXIgZW50ZXJpbmcgPSBpdGVtcy5lbnRlcigpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgnbGknKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsIChkLGkpID0+IGQua2V5ICsgJyAnICsgZC5kYXRhLml0ZW1UeXBlICsgJyBpbmRleC0nICsgaSArICggZC5kYXRhLmluc3RpdHV0aW9uID09PSAnUkZGJyB8fCBkLmRhdGEuaW5zdGl0dXRpb24gPT09ICdSZXNvdXJjZXMgZm9yIHRoZSBGdXR1cmUnID8gJyBSRkYnIDogJycpKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKCdlbnRlcmluZycsIHRydWUpXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoJ2xpc3QtaXRlbScsIHRydWUpXG4gICAgICAgICAgICAgICAgLmh0bWwoZCA9PiBjcmVhdGVSZXN1bHRJdGVtKGQpKVxuICAgICAgICAgICAgICAgIC5vbignY2xpY2snLCAoZCxpLG5vZGVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICggIWQzLmV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2RldGFpbHMtbGluaycpICl7IC8vIHByZXZlbnRzIGxpbmtzIGluIHRoZSBkZXRhaWxzIHNlY3Rpb24gZnJvbSB0cmlnZ2VyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgZXZlbnQuIHN0b3BQcm9wYWdhdGlvbigpIHdhcyBub3Qgd29ya2luZyBhcyBleHBlY3RlZFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93RGV0YWlscyhub2Rlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGVudGVyaW5nLmNsYXNzZWQoJ2VudGVyaW5nJyxmYWxzZSk7ICAgXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IGVudGVyaW5nLm1lcmdlKGl0ZW1zKTsgXG4gICAgICAgICAgICBkMy5zZWxlY3RBbGwoJy5pdGVtLXRpdGxlLWxpbmsnKVxuICAgICAgICAgICAgICAgIC5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBkMy5ldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAgICAgXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkMy5zZWxlY3RBbGwoJy5jb3B5LWJpYicpXG4gICAgICAgICAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuY29weUJpYlRleHQuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgIFxuICAgICAgICBzaG93RGV0YWlscyhsaXN0SXRlbSl7XG4gICAgICAgICAgICB2YXIgJGxpc3RJdGVtID0gZDMuc2VsZWN0KGxpc3RJdGVtKTtcbiAgICAgICAgICAgICRsaXN0SXRlbVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKCdzaG93LWRldGFpbHMnLCAhJGxpc3RJdGVtLmNsYXNzZWQoJ3Nob3ctZGV0YWlscycpKTtcbiAgICAgICAgfSxcbiAgICAgICAgZmlsdGVyU3ludGhlc2lzUmVzdWx0cyhtYXRjaGVzKXsgLy8gbmVlZHMgdG8gYmUgbW9yZSBEUlkgcmU6IGNvZGUgYWJvdmVcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1hdGNoZXMpO1xuICAgICAgICAgICAgdmFyIGl0ZW1zID0gZDMuc2VsZWN0KCcjc3ludGhlc2lzLXJlc3VsdHMgdWwnKS5zZWxlY3RBbGwoJy5saXN0LWl0ZW0nKVxuICAgICAgICAgICAgICAgIC5kYXRhKG1hdGNoZXMsIGQgPT4gZC5kYXRhLmtleSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbXMpO1xuICAgICAgICAgICAgaXRlbXMuZXhpdCgpXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoJ2VudGVyZWQnLGZhbHNlKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKCdleGl0aW5nJywgdHJ1ZSlcbiAgICAgICAgICAgICAgICAudHJhbnNpdGlvbigxNTAwKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgdmFyIGVudGVyaW5nID0gaXRlbXMuZW50ZXIoKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoJ2xpJylcbiAgICAgICAgICAgICAgICAuYXR0cignaWQnLCBkID0+IGQua2V5KVxuICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsIChkLGkpID0+ICggZC5zeW50aGVzaXNUeXBlLmNsZWFuU3RyaW5nKCkgfHwgZC5kYXRhLml0ZW1UeXBlICkgICsgJyBpbmRleC0nICsgaSArICggZC5kYXRhLmluc3RpdHV0aW9uID09PSAnUkZGJyB8fCBkLmRhdGEuaW5zdGl0dXRpb24gPT09ICdSZXNvdXJjZXMgZm9yIHRoZSBGdXR1cmUnID8gJyBSRkYnIDogJycpKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKCdSRkYnLCB0cnVlKVxuICAgICAgICAgICAgICAgIC5jbGFzc2VkKCdlbnRlcmluZycsIHRydWUpXG4gICAgICAgICAgICAgICAgLmNsYXNzZWQoJ2xpc3QtaXRlbScsIHRydWUpXG4gICAgICAgICAgICAgICAgLmh0bWwoZCA9PiBjcmVhdGVSZXN1bHRJdGVtKGQpKVxuICAgICAgICAgICAgICAgIC5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cub3BlbignLi9wZGYvJyArIHRoaXMuaWQgKyAnLnBkZicsICdfYmxhbmsnKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGVudGVyaW5nLmNsYXNzZWQoJ2VudGVyaW5nJyxmYWxzZSk7ICAgIFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuc3ludGhlc2lzSXRlbXMgPSBlbnRlcmluZy5tZXJnZShpdGVtcyk7IFxuXG4gICAgICAgICAgICBkMy5zZWxlY3RBbGwoJy5pdGVtLXRpdGxlLWxpbmsnKVxuICAgICAgICAgICAgICAgIC5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBkMy5ldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAgICAgXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuICAgIH07XG4gICAgd2luZG93LlJGRkFwcCA9IHtcbiAgICAgICAgY29udHJvbGxlcixcbiAgICAgICAgbW9kZWwgXG4gICAgfTtcbiAgICBjb250cm9sbGVyLmluaXQodHJ1ZSk7IC8vIHBhc3MgaW4gYHRydWVgIHRvIHVzZSBsb2NhbCBzbmFwc2hvdCBpbnN0ZWFkIG9mIEFQSVxuICAgICBcbn0oKSk7IC8vIGVuZCBJSUZFICJdLCJzb3VyY2VSb290IjoiIn0=